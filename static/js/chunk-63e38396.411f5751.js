(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-63e38396"],{"77c4":function(e,t,o){"use strict";o.d(t,"b",(function(){return n})),o.d(t,"a",(function(){return i})),o.d(t,"c",(function(){return l}));var a=o("b775");function n(e,t){return Object(a["a"])({url:"audit/post-audit-observation?isAddCAR="+t,method:"post",data:e})}function i(){return Object(a["a"])({url:"audit/get-audit-for-car",method:"get"})}function l(e){return Object(a["a"])({url:"correctiveaction/post-corrective",method:"post",data:e})}},"982f":function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingoverall,expression:"loadingoverall"}]},[o("b-card",{attrs:{header:"Audit Logs Entry"}},[o("b-row",[o("b-col",[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"audit-description"}},[e._v("Description")]),e._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.newAuditLog.description,expression:"newAuditLog.description"}],staticClass:"form-control",attrs:{id:"audit-description",type:"text",name:"audit-description",placeholder:"Description"},domProps:{value:e.newAuditLog.description},on:{input:function(t){t.target.composing||e.$set(e.newAuditLog,"description",t.target.value)}}})])]),e._v(" "),o("b-col",[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"audit-date"}},[e._v("Audit Date")]),e._v(" "),o("b-form-datepicker",{attrs:{id:"audit-date","date-format-options":{year:"numeric",month:"numeric",day:"numeric"}},model:{value:e.selectedAuditDate,callback:function(t){e.selectedAuditDate=t},expression:"selectedAuditDate"}})],1)])],1),e._v(" "),o("b-row",[o("b-col",[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"root-cause"}},[e._v("Root Cause")]),e._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.newAuditLog.rootcause,expression:"newAuditLog.rootcause"}],staticClass:"form-control",attrs:{id:"root-cause",type:"text",name:"root-cause",placeholder:"Root Cause"},domProps:{value:e.newAuditLog.rootcause},on:{input:function(t){t.target.composing||e.$set(e.newAuditLog,"rootcause",t.target.value)}}})])])],1),e._v(" "),o("b-row",[o("b-col",[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"category"}},[e._v("Category")]),e._v(" "),o("cool-select",{attrs:{id:"category",size:"sm",items:e.dropdowns.filter((function(e){return"Audit Category"==e.category})).map((function(e){return e.description})),name:"category",placeholder:"Category"},on:{select:function(t){return e.updateTimeline()}},model:{value:e.newAuditLog.category,callback:function(t){e.$set(e.newAuditLog,"category",t)},expression:"newAuditLog.category"}})],1)]),e._v(" "),o("b-col",[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"action-plan-timeline"}},[e._v("Types of Audit")]),e._v(" "),o("cool-select",{attrs:{items:e.auditTypes,size:"sm",placeholder:"Type"},model:{value:e.newAuditLog.type,callback:function(t){e.$set(e.newAuditLog,"type",t)},expression:"newAuditLog.type"}})],1)])],1),e._v(" "),o("b-row",[o("b-col",[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"action-plan"}},[e._v("Action Plan")]),e._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.newAuditLog.actionplan,expression:"newAuditLog.actionplan"}],staticClass:"form-control",attrs:{id:"action-plan",type:"text",name:"action-plan",placeholder:"Action Plan"},domProps:{value:e.newAuditLog.actionplan},on:{input:function(t){t.target.composing||e.$set(e.newAuditLog,"actionplan",t.target.value)}}})])]),e._v(" "),o("b-col",[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"action-plan-timeline"}},[e._v("Timeline")]),e._v(" "),o("b-form-datepicker",{attrs:{id:"action-plan-timeline","date-format-options":{year:"numeric",month:"numeric",day:"numeric"}},model:{value:e.selectedTimeline,callback:function(t){e.selectedTimeline=t},expression:"selectedTimeline"}})],1)])],1),e._v(" "),o("b-row",[o("b-col",[o("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"form-group"},[o("label",{attrs:{for:"action-plan"}},[e._v("Responsible")]),e._v(" "),o("vue-bootstrap-typeahead",{attrs:{data:e.employee,serializer:function(e){return e.employeename2},size:"md",placeholder:"Responsible"},on:{hit:function(t){return e.selectResp(t)}},model:{value:e.newAuditLog.responsiblename,callback:function(t){e.$set(e.newAuditLog,"responsiblename",t)},expression:"newAuditLog.responsiblename"}})],1)]),e._v(" "),o("b-col",[o("div",{staticClass:"form-group"},[o("label",{attrs:{for:"action-plan"}},[e._v("Department")]),e._v(" "),o("b-input",{attrs:{disabled:""},model:{value:e.newAuditLog.responsibledeptname,callback:function(t){e.$set(e.newAuditLog,"responsibledeptname",t)},expression:"newAuditLog.responsibledeptname"}})],1)])],1),e._v(" "),o("b-row",[o("b-col",[o("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"form-group"},[o("label",{attrs:{for:"action-plan-timeline"}},[e._v("Collaborator")]),e._v(" "),o("vue-bootstrap-typeahead",{attrs:{data:e.employee,serializer:function(e){return e.employeename2},size:"md",placeholder:"Collaborator"},on:{hit:function(t){return e.selectCollaborator(t)}},model:{value:e.newAuditLog.collabname,callback:function(t){e.$set(e.newAuditLog,"collabname",t)},expression:"newAuditLog.collabname"}})],1)]),e._v(" "),o("b-col",[o("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"form-group"},[o("label",{attrs:{for:"action-plan-timeline"}},[e._v("Auditor")]),e._v(" "),o("vue-bootstrap-typeahead",{attrs:{data:e.employee,serializer:function(e){return e.employeename2},size:"md",placeholder:"Auditor"},on:{hit:function(t){return e.selectAuditor(t)}},model:{value:e.newAuditLog.auditorname,callback:function(t){e.$set(e.newAuditLog,"auditorname",t)},expression:"newAuditLog.auditorname"}})],1)])],1),e._v(" "),o("b-row",{staticClass:"text-center"},[o("b-col",[o("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal",value:"confirm-modal",expression:"'confirm-modal'"}],attrs:{variant:"success"}},[e._v("Save")])],1)],1)],1),e._v(" "),o("b-modal",{attrs:{id:"confirm-modal","hide-footer":""},scopedSlots:e._u([{key:"modal-title",fn:function(){return[e._v("Confirmation")]},proxy:!0}])},[e._v("\r\n        Saving this will also automatically generate a Corrective Action Report and a paloup issue. Do you still want to continue?\r\n        "),o("b-button",{staticClass:"mt-3",attrs:{variant:"success",block:""},on:{click:function(t){return e.saveAudit()}}},[e._v("Save")]),e._v(" "),o("b-button",{staticClass:"mt-2",attrs:{block:"",variant:"danger"},on:{click:function(t){return e.$bvModal.hide("confirm-modal")}}},[e._v("Cancel")])],1)],1)},n=[],i=(o("ac6a"),o("456d"),o("28a5"),o("77c4")),l=o("0eed"),r=o("3698"),s=(o("8ad2d"),o("a4f0")),d={components:{CoolSelect:r["a"]},data:function(){return{selectedTimeline:new Date,selectedAuditDate:new Date,loadingoverall:!1,auditTypes:["Fast Internal Audit","Process Audit","Certification Audit","Surveillance Audit","Customer Audit","Client Audit"],selectedResp:{branchname:null},loading:!1,newAuditLog:{category:null,description:null,rootcause:null,actionplan:null,responsibleempid:null,responsiblename:null,responsibledeptid:null,responsibledeptname:null,responsibleemail:null,type:null,auditorempid:null,auditorname:null,auditdate:(new Date).toLocaleDateString(),auditordeptid:null,auditordeptname:null,auditoremail:null,timeline:null,createdate:null,createby:this.$store.state.user.userInfo.emplId,collabempid:null,collabname:null,collabdeptid:null,collabdeptname:null,collabemail:null}}},computed:{employee:function(){return this.$store.state.data.employees},dropdowns:function(){return this.$store.state.data.dropdown}},watch:{selectedAuditDate:function(){var e=this.selectedAuditDate.split("-");this.newAuditLog.auditdate=e[1]+"/"+e[2]+"/"+e[0]},selectedTimeline:function(){var e=this.selectedTimeline.split("-");this.newAuditLog.timeline=e[1]+"/"+e[2]+"/"+e[0]}},beforeDestroy:function(){this.$store.state.data.auditData=this.newAuditLog},created:function(){Object.keys(this.$store.state.data.auditData).length>0&&(this.newAuditLog=this.$store.state.data.auditData),0==this.employee.length&&this.getEmployees()},methods:{postQMSIssue:function(e){var t=this,o=this,a={type:"CAR",Responsible:{memberID:o.newAuditLog.responsibleempid,fullname:o.newAuditLog.responsiblename,emailaddress:o.newAuditLog.responsibleemail,mobileno:o.employee.filter((function(e){return e.empl_id==o.newAuditLog.responsibleempid}))[0].employeepresentcontact,created_by:o.$store.state.user.userInfo.emplId,nickname:null,status:"A"},Issue:{issuedetails:o.newAuditLog.description,actionplan:o.newAuditLog.actionplan,targetcompletiondate:o.newAuditLog.timeline,raisedby:o.newAuditLog.auditorname,raisedbyemail:o.newAuditLog.auditoremail,raisedbyempid:o.newAuditLog.auditorempid,raisedbyphone:o.employee.filter((function(e){return e.empl_id==o.newAuditLog.auditorempid}))[0].employeepresentcontact,responsible:o.newAuditLog.responsiblename,responemail:o.newAuditLog.responsibleemail,responempid:o.newAuditLog.responsibleempid,responphone:o.employee.filter((function(e){return e.empl_id==o.newAuditLog.responsibleempid}))[0].employeepresentcontact,followfrequency:7,followmail:1,followsms:1,referenceId:e,referencetype:"QMS",collaboratorname:o.newAuditLog.collabname,collaboratoremail:o.newAuditLog.collabemail,collaboratorempid:o.newAuditLog.collabempid,category:"I",pflag:1,issuetype:2,acknowledgebyrespondent:0,acknowledgedbysource:0,sourcetype:"M",fupcounter:0,status:"O",meetingId:0,created_by:o.$store.state.user.userInfo.emplId}};return o.loadingoverall=!0,new Promise((function(e,n){Object(s["a"])(a).then((function(a){o.newAuditLog={category:null,description:null,rootcause:null,actionplan:null,responsibleempid:null,responsiblename:null,responsibledeptid:null,responsibledeptname:null,responsibleemail:null,type:null,auditorempid:null,auditorname:null,auditdate:(new Date).toLocaleDateString(),auditordeptid:null,auditordeptname:null,auditoremail:null,timeline:null,createdate:null,createby:t.$store.state.user.userInfo.emplId,collabempid:null,collabname:null,collabdeptid:null,collabdeptname:null,collabemail:null},o.loadingoverall=!1,o.$message({showClose:!0,message:"Successfully saved!",type:"success"}),e()})).catch((function(e){o.loadingoverall=!1,n(e)}))}))},updateTimeline:function(){var e=0;"Critical Major"==this.newAuditLog.category||"Major"==this.newAuditLog.category?e=30:"Minor"==this.newAuditLog.category?e=60:"Observation"==this.newAuditLog.category&&(e=14);var t=new Date(this.selectedAuditDate);t.setDate(t.getDate()+e),this.selectedTimeline=t;var o=this.selectedTimeline.toLocaleDateString();this.newAuditLog.timeline=o},selectAuditor:function(e){this.newAuditLog.auditorempid=e.empl_id,this.newAuditLog.auditordeptid=e.department,this.newAuditLog.auditordeptname=e.departmentname,this.newAuditLog.auditordeptname=e.departmentname,this.newAuditLog.auditoremail=e.emailadd},selectCollaborator:function(e){this.newAuditLog.collabempid=e.empl_id,this.newAuditLog.collabdeptid=e.department,this.newAuditLog.collabdeptname=e.departmentname,this.newAuditLog.collabdeptname=e.departmentname,this.newAuditLog.collabemail=e.emailadd},selectResp:function(e){this.newAuditLog.responsibleempid=e.empl_id,this.newAuditLog.responsibledeptid=e.department,this.newAuditLog.responsibledeptname=e.departmentname,this.newAuditLog.responsibledeptname=e.departmentname,this.newAuditLog.responsibleemail=e.emailadd},saveAudit:function(){var e=this;return e.$bvModal.hide("confirm-modal"),e.loadingoverall=!0,new Promise((function(t,o){Object(i["b"])(e.newAuditLog,1).then((function(o){e.postQMSIssue(o.data),t()})).catch((function(t){e.loadingoverall=!1,o(t)}))}))},getEmployees:function(){var e=this;return e.loading=!0,new Promise((function(t,o){Object(l["d"])().then((function(t){e.$store.state.data.employees=t.data,e.loading=!1})).catch((function(t){e.loading=!1,o(t)}))}))}}},u=d,c=o("2877"),p=Object(c["a"])(u,a,n,!1,null,null,null);t["default"]=p.exports},a4f0:function(e,t,o){"use strict";var a=o("bc3a"),n=o.n(a),i=o("5c96"),l=o("4360"),r=o("5f87"),s=o("0f9a"),d=n.a.create({baseURL:"http://apps.fastlogistics.com.ph/paloupapi/api/",timeout:1e5});d.interceptors.request.use((function(e){return l["a"].getters.token&&(s["authorization"]&&(e.headers["Authorization"]=s["authorization"]),e.headers["token"]=Object(r["b"])(),e.headers["serverwarehouseId"]=52),e}),(function(e){return console.log(e),Promise.reject(e)})),d.interceptors.response.use((function(e){var t=e.data;return 200!==e.status?(Object(i["Message"])({message:t.message||"Error",type:"error",duration:5e3}),50008!==e.status&&50012!==e.status&&50014!==e.status||i["MessageBox"].confirm("You have been logged out, you can cancel to stay on this page, or log in again","Confirm logout",{confirmButtonText:"Re-Login",cancelButtonText:"Cancel",type:"warning"}).then((function(){l["a"].dispatch("user/resetToken").then((function(){location.reload()}))})),Promise.reject(new Error(t.message||"Error"))):e}),(function(e){return console.log("err"+e),Object(i["Message"])({message:e.message,type:"error",duration:5e3}),Promise.reject(e)}));var u=d;function c(e){return u({url:"mifs/post-qms-issue",method:"post",data:e})}o.d(t,"a",(function(){return c}))}}]);