(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e0d4e93e"],{"3fae":function(e,a,t){"use strict";t.d(a,"b",(function(){return i})),t.d(a,"d",(function(){return l})),t.d(a,"c",(function(){return o})),t.d(a,"a",(function(){return d}));var n=t("b775");function i(e){return Object(n["a"])({url:"changenotice/post-changenotice",method:"post",data:e})}function l(e){return Object(n["a"])({url:"changenotice/post-changenotice-review?cid="+e.cid+"&isAgree="+e.isAgree,method:"post"})}function o(e){return Object(n["a"])({url:"changenotice/post-changenotice-approval?cnid="+e.cid+"&isAgree="+e.isAgree,method:"post"})}function d(e){return Object(n["a"])({url:"changenotice/get-changenotice",method:"post",filter:e})}},"77fe":function(e,a,t){"use strict";t.r(a);var n=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingoverall,expression:"loadingoverall"}]},[t("b-card",{attrs:{header:"Change Notice Entry"}},[t("b-container",{attrs:{fluid:""}},[t("b-form",[t("b-row",[t("b-col",[t("label",{attrs:{for:"cnsite"}},[e._v("Site:")]),e._v(" "),t("cool-select",{directives:[{name:"loading",rawName:"v-loading",value:e.branchLoading,expression:"branchLoading"}],attrs:{id:"cnsite",successful:null!=e.dataValue.selectedSite,items:e.branchlists.map((function(e){return e.branname})),placeholder:"Select Site"},on:{select:function(a){return e.selectSite(e.dataValue.selectedSite)}},model:{value:e.dataValue.selectedSite,callback:function(a){e.$set(e.dataValue,"selectedSite",a)},expression:"dataValue.selectedSite"}})],1),e._v(" "),t("b-col",[t("label",{attrs:{for:"cnsite"}},[e._v("Initiator/Owner of the Change:")]),e._v(" "),t("vue-bootstrap-typeahead",{directives:[{name:"loading",rawName:"v-loading",value:e.empLoading,expression:"empLoading"}],attrs:{id:"cnsite",size:"lg",data:e.employeelists.map((function(e){return e.employeename2})),placeholder:"Select Initiator"},on:{hit:function(a){return e.selectInitiator(e.dataValue.newCN.initiatorname)}},model:{value:e.dataValue.newCN.initiatorname,callback:function(a){e.$set(e.dataValue.newCN,"initiatorname",a)},expression:"dataValue.newCN.initiatorname"}})],1)],1),e._v(" "),t("b-row",[t("b-col",[t("label",{attrs:{for:"cntype"}},[e._v("Type of Change:")]),e._v(" "),t("cool-select",{attrs:{id:"cntype","V-loading":"dropdownLoading",successful:null!=e.dataValue.newCN.type,items:e.dropdown.filter((function(e){return"Type of Change"==e.category})).map((function(e){return e.description})),placeholder:"Select Type"},model:{value:e.dataValue.newCN.type,callback:function(a){e.$set(e.dataValue.newCN,"type",a)},expression:"dataValue.newCN.type"}})],1),e._v(" "),t("b-col",[t("label",{attrs:{for:"cnnature"}},[e._v("Nature of Change:")]),e._v(" "),t("cool-select",{directives:[{name:"loading",rawName:"v-loading",value:e.dropdownLoading,expression:"dropdownLoading"}],attrs:{id:"cnnature",successful:null!=e.dataValue.newCN.nature,items:e.dropdown.filter((function(e){return"Nature of Change"==e.category})).map((function(e){return e.description})),placeholder:"Select Nature"},model:{value:e.dataValue.newCN.nature,callback:function(a){e.$set(e.dataValue.newCN,"nature",a)},expression:"dataValue.newCN.nature"}})],1)],1),e._v(" "),t("b-row",[t("b-col",[t("label",{attrs:{for:"cndescription"}},[e._v("Brief Description of the Proposed Change:")]),e._v(" "),t("b-textarea",{attrs:{id:"cndescription"},model:{value:e.dataValue.newCN.description,callback:function(a){e.$set(e.dataValue.newCN,"description",a)},expression:"dataValue.newCN.description"}})],1)],1),e._v(" "),t("b-row",[t("b-col",[t("label",{attrs:{for:"cnobjective"}},[e._v("Objective of Change:")]),e._v(" "),t("b-textarea",{attrs:{id:"cnobjective"},model:{value:e.dataValue.newCN.objective,callback:function(a){e.$set(e.dataValue.newCN,"objective",a)},expression:"dataValue.newCN.objective"}})],1)],1),e._v(" "),t("b-card",{staticClass:"my-2",attrs:{header:"Consultation and Review Team"}},[e._l(e.dataValue.reviewTeam,(function(a,n){return t("b-row",{key:a.section},[t("b-col",[t("label",{attrs:{for:a.section}},[e._v(e._s(a.section)+":")]),e._v(" "),0==a.isadditional?t("vue-bootstrap-typeahead",{directives:[{name:"loading",rawName:"v-loading",value:e.empLoading,expression:"empLoading"}],attrs:{id:a.section,size:"lg",data:e.employeelists.map((function(e){return e.employeename2})),placeholder:"Reviewer"},on:{hit:function(a){return e.selectReviewer(e.dataValue.reviewTeam[n].name,n)}},model:{value:e.dataValue.reviewTeam[n].name,callback:function(a){e.$set(e.dataValue.reviewTeam[n],"name",a)},expression:"dataValue.reviewTeam[index].name"}}):t("b-input",{attrs:{disabled:""},model:{value:e.dataValue.reviewTeam[n].name,callback:function(a){e.$set(e.dataValue.reviewTeam[n],"name",a)},expression:"dataValue.reviewTeam[index].name"}})],1),e._v(" "),1==a.isadditional?t("b-col",{staticClass:"mt-4",attrs:{cols:"1"}},[t("b-button",{attrs:{variant:"danger"},on:{click:function(a){return e.removeRev(n)}}},[e._v("Delete")])],1):e._e()],1)})),e._v(" "),t("b-row",[t("b-col",[t("label",{attrs:{for:"newReviewer"}},[e._v("Others, please specify:\r\n                                "),t("b-form-input",{attrs:{placeholder:"Section/Department"},model:{value:e.dataValue.additionalReviewer.section,callback:function(a){e.$set(e.dataValue.additionalReviewer,"section",a)},expression:"dataValue.additionalReviewer.section"}})],1),e._v(" "),t("b-input-group",{scopedSlots:e._u([{key:"append",fn:function(){return[t("b-button",{attrs:{variant:"success"},on:{click:function(a){return e.addReviewer()}}},[e._v("Add")])]},proxy:!0}])},[t("vue-bootstrap-typeahead",{directives:[{name:"loading",rawName:"v-loading",value:e.empLoading,expression:"empLoading"}],key:e.ref,attrs:{id:"newReviewer",size:"lg",data:e.employeelists.map((function(e){return e.employeename2})),placeholder:"Reviewer"},on:{hit:function(a){return e.selectReviewer(e.dataValue.additionalReviewer.name,-1)}},model:{value:e.dataValue.additionalReviewer.name,callback:function(a){e.$set(e.dataValue.additionalReviewer,"name",a)},expression:"dataValue.additionalReviewer.name"}})],1)],1)],1),e._v(" "),t("b-row",{staticClass:"my-2"},[t("b-col",{staticClass:"text-center"},[t("b-button",{attrs:{disabled:!e.validInputs,variant:"success"},on:{click:function(a){return e.postCN()}}},[e._v("Save")])],1)],1)],2)],1)],1)],1)],1)},i=[],l=(t("ac6a"),t("456d"),t("3fae")),o=t("3698"),d=(t("0eed"),{components:{CoolSelect:o["a"]},data:function(){return{dataValue:{ref:1,additionalReviewer:{emplid:null,name:"",deptcode:null,deptname:null,section:"",email:null,isactive:1,isadditional:1},newCN:{brancode:"",deptcode:"",deptname:"",initiatorname:"",initiatoremplid:"",initiatoremail:"",type:"",nature:"",description:"",objective:"",approveremplid:null,approvername:null,approveremail:null,createdby:null},reviewTeam:[{emplid:null,name:"",deptcode:null,deptname:null,section:"Safety & Health",email:null,isactive:1,isadditional:0},{emplid:null,name:"",deptcode:null,deptname:null,section:"QMS/Ops Excellence",email:null,isactive:1,isadditional:0},{emplid:null,name:"",deptcode:null,deptname:null,section:"Operations",email:null,isactive:1,isadditional:0},{emplid:null,name:"",deptcode:null,deptname:null,section:"Bldg./Facility",email:null,isactive:1,isadditional:0},{emplid:null,name:"",deptcode:null,deptname:null,section:"HR",email:null,isactive:1,isadditional:0},{emplid:null,name:"",deptcode:null,deptname:null,section:"Procurement",email:null,isactive:1,isadditional:0},{emplid:null,name:"",deptcode:null,deptname:null,section:"Finance",email:null,isactive:1,isadditional:0},{emplid:null,name:"",deptcode:null,deptname:null,section:"Sales, Mktg & Bus. Dev.",email:null,isactive:1,isadditional:0}],selectedSite:"",initiatorname:""},branchLoading:!1,empLoading:!1,loadingoverall:!1,dropdownLoading:!1}},computed:{branchlists:function(){return this.$store.state.data.branchlist},employeelists:function(){return this.$store.state.data.employees},dropdown:function(){return this.$store.state.data.dropdown},validInputs:function(){return null!=this.dataValue.selectedSite&&this.dataValue.selectedSite.length>0}},beforeDestroy:function(){this.$store.state.data.cnData=this.dataValue},created:function(){this.loadingoverall=!0,Object.keys(this.$store.state.data.cnData).length>0&&(this.dataValue=this.$store.state.data.cnData),0==this.$store.state.data.employees.length&&this.getEmployeeList(),0==this.$store.state.data.branchlist.length&&this.getBranch(),0==this.$store.state.data.dropdown.length&&this.getDropdown(),this.loadingoverall=!1},methods:{removeRev:function(e){this.dataValue.reviewTeam.splice(e,1)},addReviewer:function(){this.dataValue.ref+=1,this.dataValue.reviewTeam.push(this.dataValue.additionalReviewer),this.dataValue.additionalReviewer={emplid:null,name:"",deptcode:null,deptname:null,section:"",email:null,isactive:1,isadditional:1}},getDropdown:function(){var e=this;e.dropdownLoading=!0,e.$store.dispatch("data/getDropdownList").then((function(a){e.dropdownLoading=!1})).catch((function(a){e.dropdownLoading=!1,reject(a)}))},selectInitiator:function(e){var a=this.employeelists.filter((function(a){return a.employeename2==e}))[0];this.dataValue.newCN.approveremplid=a.ImmediateID,this.dataValue.newCN.approvername=a.ImmediateName,this.dataValue.newCN.approveremail=a.ImmediateEmail,this.dataValue.newCN.initiatoremplid=a.empl_id,this.dataValue.newCN.initiatoremail=a.emailadd,this.dataValue.newCN.deptcode=a.department,this.dataValue.newCN.deptname=a.departmentname},selectReviewer:function(e,a){var t=this.employeelists.filter((function(a){return a.employeename2==e}))[0];a>-1?(this.dataValue.reviewTeam[a].deptcode=t.department,this.dataValue.reviewTeam[a].deptname=t.departmentname,this.dataValue.reviewTeam[a].emplid=t.empl_id,this.dataValue.reviewTeam[a].email=t.emailadd):(this.dataValue.additionalReviewer.deptcode=t.department,this.dataValue.additionalReviewer.deptname=t.departmentname,this.dataValue.additionalReviewer.emplid=t.empl_id,this.dataValue.additionalReviewer.email=t.emailadd)},postCN:function(){var e=this,a=this;return a.loadingoverall=!0,new Promise((function(t,n){Object(l["b"])({CN:a.dataValue.newCN,Rev:a.dataValue.reviewTeam}).then((function(t){e.dataValue={newCN:{brancode:"",deptcode:"",deptname:"",initiatorname:"",initiatoremplid:"",initiatoremail:"",type:"",nature:"",description:"",objective:"",approveremplid:null,approvername:null,approveremail:null,createdby:null},reviewTeam:[{emplid:null,name:"",deptcode:null,deptname:null,section:"Safety & Health",email:null,isactive:1},{emplid:null,name:"",deptcode:null,deptname:null,section:"QMS/Ops Excellence",email:null,isactive:1},{emplid:null,name:"",deptcode:null,deptname:null,section:"Operations",email:null,isactive:1},{emplid:null,name:"",deptcode:null,deptname:null,section:"Bldg./Facility",email:null,isactive:1},{emplid:null,name:"",deptcode:null,deptname:null,section:"HR/Training",email:null,isactive:1},{emplid:null,name:"",deptcode:null,deptname:null,section:"Finance",email:null,isactive:1}],selectedSite:"",initiatorname:""},a.loadingoverall=!1,a.$message({showClose:!0,message:t.data,type:"success"})})).catch((function(e){a.$message({showClose:!0,message:"Unable to save!",type:"danger"}),a.loadingoverall=!1}))}))},selectSite:function(e){this.dataValue.newCN.brancode=this.branchlists.filter((function(a){return a.branname==e}))[0].brancode},getBranch:function(){var e=this;return e.branchLoading=!0,new Promise((function(a,t){e.$store.dispatch("data/getBranchList").then((function(a){console.log("branch",e.$store.state.data.branchlist),e.branchLoading=!1})).catch((function(a){console.log(a),e.branchLoading=!1,t(a)}))}))},getEmployeeList:function(){var e=this;return e.empLoading=!0,new Promise((function(a,t){e.$store.dispatch("data/getEmployees").then((function(t){e.empLoading=!1,a()})).catch((function(a){e.empLoading=!1,t(a)}))}))}}}),r=d,s=t("2877"),c=Object(s["a"])(r,n,i,!1,null,null,null);a["default"]=c.exports}}]);